<ng-container *ngIf="!currentSoftware">
    <div class="layout-content-empty">
    <span class="card-text">
    SELECCIONE UN ITEM PARA VER SU INFORMACIÓN
    </span>
        <img
                class="img-fluid"
                src="/assets/img/search-document.svg" alt="Búsqueda software">
    </div>
</ng-container>
<ng-container *ngIf="currentSoftware">
    <div class="row">
        <div class="layout-wrapper custom-form">
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-12">
                            <app-actions-toolbar
                                    [showEdit]="true"
                                    [showDelete]="false"
                                    (onEdit)="editSoftware()"
                            ></app-actions-toolbar>
                        </div>
                        <div class="col-sm-12 col-md-12">
                            <div class="d-flex justify-content-start w-100">
                                <div class="justify-content">
                                    <ng-container *ngIf="hasTechnicalKey()">
                                        <button class="btn custom-button border fas-fa-save me-25"
                                                [disabled]="!isProduction()"
                                                (click)="onGetTechnicalKey()">
                                            <i class="fas fa-binoculars"></i>
                                            Consultar clave técnica
                                        </button>
                                    </ng-container>
                                    <ng-container *ngIf="(currentSoftware.type_id?.toString() !== '3') && currentSoftware?.testsetid">
                                        <button class="btn custom-button border fas-fa-save me-25"
                                                (click)="onRunTest()">
                                            <i class="fas fa-running fas-fa-save"></i>
                                            Iniciar habilitación
                                        </button>
                                    </ng-container>
                                    <button
                                            class="btn custom-button border fas-fa-ok-thumbs"
                                            [disabled]="isProduction()"
                                            (click)="onFinished()">
                                        <i class="fas fa-thumbs-up"></i>
                                        Finalizar habilitación
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="content-div">
                <hr>
            </div>
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-5">
                            <div class="form-group">
                                <label>Tipo de documento</label>
                                <p class="card-text">
                                    <strong>{{ currentSoftware.typeDescription | uppercase }}</strong>
                                </p>
                            </div>
                        </div>
                        <div class="col-sm-7">
                            <div class="form-group">
                                <label>Identificación del Software</label>
                                <p class="card-text">
                                    {{currentSoftware.identification}}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="content-div">
                <hr>
            </div>
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-4">
                            <div class="form-group">
                                <label>PIN</label>
                                <p class="card-text">
                                    <strong>{{ currentSoftware.pin }}</strong>
                                </p>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                <label>Número inicial del folio de habilitación</label>
                                <p class="card-text">
                                    <strong>{{currentSoftware.initial_number }}</strong>
                                </p>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                <label>Ambiente de operación</label>
                                <p class="card-text">
                                    <strong>
                                        {{ getEnvironment() | uppercase}}
                                    </strong>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="content-div">
                <hr>
            </div>
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="form-group">
                                <label><b>Clave técnica</b></label>
                                <p class="card-text">
                                    {{ currentSoftware.technical_key }}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <ng-container *ngIf="currentSoftware.testsetid">
            <div class="content-div">
                <hr>
            </div>
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="form-group">
                                <label><b>TestSetId - DIAN</b></label>
                                <p class="card-text">
                                    {{ currentSoftware.testsetid }}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </ng-container>
            <ng-container *ngIf="currentSoftware?.test_process">
                <div class="content-div">
                    <hr>
                </div>
                <div class="card">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="p-25" [class]="'document-status-' + currentSoftware.test_process.status">
                                    <span>Estado de la habilitación: <b>{{currentSoftware.test_process.status_description}}</b></span>
                                </div>
                            </div>
                            <div class="col-12">
                                <pre  style="color: white; background-color: #2556a3 !important;">{{getProcessData() | json}}</pre>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="content-div">
                    <hr>
                </div>
                <div class="card">
                    <div class="card-body table-responsive">
                        <table class="table table-striped table-bordered table-layout-content shadow">
                            <thead>
                            <tr>
                                <th>Documento</th>
                                <th>Número</th>
                                <th>ZipKey</th>
                                <th>Estado DIAN</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr *ngFor="let document of currentSoftware.test_process.documents">
                                <td>{{ document.document.voucher_name }}</td>
                                <td>{{ document.document_number }}</td>
                                <td>{{ document.zipkey }}</td>
                                <td>
                                    <button
                                            (click)="onStatusTest(document.zipkey)"
                                            class="btn btn-success">
                                        Validar
                                    </button>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="card" *ngIf="dataDian">
                    <div class="card-body">
                        <div class="row">
                            <div class="col">
                                <pre  style="color: white; background-color: #2556a3;">{{dataDian | json}}</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </ng-container>
            <div class="content-div">
                <hr>
            </div>
            <div class="card" *ngIf="data">
                <div class="card-body">
                    <div class="row">
                        <div class="col">
                            <pre  style="color: white; background-color: #2556a3;">{{data | json}}</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</ng-container>