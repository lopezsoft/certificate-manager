<ng-container *ngIf="!currentShipping">
    <div class="layout-content-empty">
    <span class="card-text">
    SELECCIONE UN DOCUMENTO PARA VER SU INFORMACIÓN
    </span>
        <img
                class="img-fluid"
                src="/assets/img/search-document.svg" alt="Búsqueda documento">
    </div>
</ng-container>
<ng-container *ngIf="currentShipping">
    <div class="row" [@fadeInOut]>
        <div class="layout-wrapper custom-form">
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-12 col-md-12">
                            <div class="d-flex justify-content-start w-100">
                                <div class="justify-content">
                                    <button
                                            *ngIf="currentShipping.request_status === DocumentStatusEnum.SENT"
                                            class="btn custom-button border me-25 fas-fa-save"
                                            (click)="updateStatus(DocumentStatusEnum.ACCEPTED)"
                                            appCustomTooltip="Aceptar solicitud">
                                        <i class="fas fa-paper-plane fa-cursor fas-fa-save"></i>
                                        Aceptar solicitud
                                    </button>
                                    <button
                                            *ngIf="canSendEmail()"
                                            class="btn custom-button border me-25 fas-fa-mail-send"
                                            (click)="sendEmail(DocumentStatusEnum.PROCESSING)"
                                            appCustomTooltip="Enviar correo de solicitud" >
                                        <i class="fas fa-paper-plane fa-cursor fas-fa-mail-send"></i>
                                        Procesar solicitud
                                    </button>
                                    <!-- Reject button -->
                                    <button
                                            *ngIf="canReject()"
                                            [disabled]="canRejectRequest"
                                            class="btn custom-button border me-25 fas-fa-warning"
                                            (click)="rejectRequest()"
                                            appCustomTooltip="Rechazar solicitud" >
                                        <i class="fas fa-paper-plane fa-cursor fas-fa-warning"></i>
                                        Rechazar solicitud
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <ng-container *ngIf="canRejectRequest">
                <div class="content-div">
                    <hr>
                </div>
                <div class="card">
                    <div class="card-header">
                        <span class="card-title">MOTIVO DEL RECHAZO</span>
                        <div class="card-header-actions">
                            <button
                                    class="btn custom-button fas-fa-close"
                                    (click)="canRejectRequest = false"
                                    appCustomTooltip="Cerrar">
                                <i class="fas fa-times fas-fa-16"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-body p-1">
                        <app-help-information>
                            <p>
                                Estimado usuario, por favor ingrese el motivo del rechazo de la solicitud.<br>
                                <strong>Nota:</strong> Este motivo será enviado al solicitante del certificado.<br>
                                <strong>Nota:</strong> El motivo del rechazo no puede ser vacío.
                            </p>
                        </app-help-information>
                        <div class="row">
                            <div class="col-md-12">
                                <jqxEditor #myEditor [theme]="'fluent'" [(ngModel)]='comments' [width]="'100%'" [height]="220">

                                </jqxEditor>
                            </div>
                        </div>
                        <div class="d-flex justify-content-end mt-1">
                            <button
                                    class="btn custom-button border fas-fa-close me-25"
                                    (click)="canRejectRequest = false">
                                <i class="fas fa-times fas-fa-16"></i>
                                Cancelar
                            </button>
                            <button
                                    class="btn custom-button border fas-fa-save"
                                    (click)="onRejectRequest()"
                                    [disabled]="!comments">
                                <i class="fas fa-save fas-fa-16 fas-fa-save"></i>
                                Guardar
                            </button>
                        </div>
                    </div>
                </div>
            </ng-container>
            <div class="content-div">
                <hr>
            </div>
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label>Código de la solicitud</label>
                                <div class="card-text d-grid">
                                  <span class="w-100">
                                   <strong> {{ currentShipping.uuid }} </strong>
                                  </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label>Estado de la solicitud</label>
                                <div class="card-text d-grid">
                                  <span class="w-100 text-center" [class]="'document-status-'+currentShipping.request_status">
                                    {{ documentStatusDescription[currentShipping.request_status] | uppercase }}
                                  </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="content-div">
                <hr>
            </div>
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label>N.I.T</label>
                                <p class="card-text">
                                    <strong>{{ currentShipping.dni }}-{{currentShipping.dv}}</strong>
                                </p>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label>Tipo de contribuyente</label>
                                <p class="card-text">
                                    <strong>{{currentShipping.organization.description | uppercase}}</strong>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="content-div">
                <hr>
            </div>
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Nombre o razón social</label>
                                <p class="card-text">
                                    <strong>{{ currentShipping.company_name }}</strong>
                                </p>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label>Ciudad</label>
                                <p class="card-text">
                                    <strong>{{currentShipping.city.name_city }}</strong>
                                </p>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label>Dirección</label>
                                <p class="card-text">
                                    <strong>{{currentShipping.address }}</strong>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="content-div">
                <hr>
            </div>
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="form-group">
                                <label><b>Nombre completo de representante legal</b></label>
                                <p class="card-text">
                                    {{ currentShipping.legal_representative | uppercase }}
                                </p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Tipo de documento</label>
                                <p class="card-text">
                                    <strong>{{ currentShipping.identity.document_name }}</strong>
                                </p>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label>Número del documento</label>
                                <p class="card-text">
                                    <strong>{{currentShipping.document_number }}</strong>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="content-div">
                <hr>
            </div>
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Fecha de creación</label>
                                <p class="card-text">
                                    <strong>{{ currentShipping.created_at }}</strong>
                                </p>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label>Fecha de ultimo cambio</label>
                                <p class="card-text">
                                    <strong>{{currentShipping.updated_at }}</strong>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="content-div">
                <hr>
            </div>
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Observación</label>
                                <p class="card-text">
                                    {{ currentShipping.info }}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <ng-container *ngIf="currentShipping.files.length > 0">
                <div class="content-div">
                    <hr>
                </div>
                <div class="card">
                    <div class="card-header">
                        <span class="card-title">LISTA DE ARCHIVOS</span>
                    </div>
                    <div class="card-body">
                        <div class="bg-card-container">
                            <div class="row row-cols-1 row-cols-sm-1 row-cols-md-1 g-50">
                                <div class="col" *ngFor="let file of currentShipping.files; index as i">
                                    <div class="card card-accounting-voucher h-100"
                                         [ngClass]="{'selected': file.id === selectedFile?.id}"
                                         (dblclick)="selectFile(null)"
                                         (click)="selectFile(file)"
                                    >
                                        <div class="card-body">
                                            <div class="img-container">
                                                <img src="assets/files/128/{{file.extension_file.toLowerCase()}}.png"
                                                     class="img-fluid" alt="{{ file.file_name }}">
                                            </div>
                                            <div class="card-body-content">
                                                <p class="card-text item-description mb-25 w-100">
                                                    {{ file.file_name }}
                                                </p>
                                                <div class="content-p">
                                                    <p class="card-text" title="Tamaño">
                                                        <i class="fas fa-hdd"></i>
                                                        {{ convertBytesToMB(file.file_size) }}<br>
                                                    </p>
                                                    <p class="card-text" title="Última modificación">
                                                        <i class="fas fa-calendar-day"></i> {{ file.last_modified  }}
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="actions-content">
                                                <button
                                                        class="btn custom-button fas-fa-save"
                                                        (click)="onDownload(file)">
                                                    <i class="fas fa-link fas-fa-18 fas-fa-save"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </ng-container>
        </div>
    </div>
</ng-container>